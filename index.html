
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Bhuj - A Data Story</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.3.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.3.1/mapbox-gl.css' rel='stylesheet' />


    <link rel="stylesheet" type="text/css" href="style/style.css">

    <link href="https://fonts.googleapis.com/css?family=Slabo+13px|Slabo+27px&display=swap" rel="stylesheet">


</head>
<body>

<div id='map'></div>


<div id='features'>


<div id = "filler"></div>

    <section id='starter' class = 'active'>

        <h2>The 8 worst earthquakes in the world.</h2>
        <p>Scroll down to begin</p>
        <br>

    </section>


    <section id='opening'>
        <h3>Bhuj is the headquarters of the Kutch District in Gujarat</h3>
        <p>It is located at the western end of India, and is at the boundary of the Indian and Eurasian Tectonic plates.</p>
    </section>

     <section id='number8'>
        <h3>The morning of 24 December 2000<br>Bhuj, Gujarat</h3>
        <p>The birds, crocodiles, and other wildlife at the Banni Grasslands have just been disturbed by an earthquake measuring 4.6 on the Richter scale. To them it would have probably felt like a herd of elephants stampeding nearby, which might have been a normal occurance had elephants been living in the Salt Flats of North-western Gujarat. In any case, it was a mild quake far from human settlements, one that must have gone unnoticed by most people at the time.</p>
    </section>

    <section id='number7'>
        <h3>The day before Republic Day
<br>25 January 2001</h3>
        <p>In the municipality of Bhuj, people must have been preparing to mark the occasion of Republic day, or might have been looking forward to the long weekend. Maybe neither of those things mattered, and it was just another normal day for everyone. Surely nobody was expecting anything out of the ordinary. Least of all an earthquake. Not when the last major earthquake to strike the region took place nearly half a century prior.<br><br>That relatively 'quiet' December quake a few kilometers to the north was perhaps the only indicator of what was to come.

</p>
    </section>

    <section id='number6'>
        <h3>Earthquakes in the Kutch Region<br>1956-2001</h3>
        <p>To not expect an earthquake would have been the safest thing to do, statistically speaking. In the years since the last destructive earthquake (which occured in 1956), there were hardly any major incidents in or around the state of Gujarat. Minor quakes yes, but the Rann of Kutch is near a fault line, and smaller shakes are to be expected. In the same duration, a number of much more powerful quakes struck parts of Pakistan to the north-west. There were hardly any such occurences this side of the border.</p>
    </section>

    <section id='number5'>
        <h3>Man-made earthquakes<br>The Pokharan Nuclear Tests
</h3>
        <p>In fact, we even made up for the lack of natural earthquakes by creating our own. The Pokharan Nuclear Tests in the years 1974 and 1998 resulted in the some of the largest recorded seismic activities (M5.0 and M5.2 respectively) in the area for that entire duration.

</p>
    </section>

    <section id='number4'>
        <h3>Republic Day 2001<br>Gujarat, India</h3>
        <p>And so when people living in Bhuj and the surrounding villages, towns and cities gathered in their homes and in public spaces to enjoy the holiday, they really had no reason to expect anything out of the ordinary.<br><br>Least of all one of the worst earthquakes ever to strike India.</p>
    </section>

    <section id='number3'>
        <h3>Bhuj Day One<br>26 January 2001</h3>
        <p>The first earthquake struck at 8:46 AM IST, and measured 7.7 on the Richter scale. <br> But earthquakes are never just lone visitors. Through the rest of the day, there were 18 aftershock earthquakes, all of which would have been felt by the people in the region. First responders and victims alike would have had to deal with the trauma and the fear of something worse to come each time one of the smaller earthquakes struck.</p>
    </section>

    <section id='number2'>
        <h3>The Month After<br>February 2001</h3>
        <p>Some sort of switch flipped in the region after Bhuj. In just the next month, there were nearly 60 measurable earthquakes. Over the whole year, 118 earthquakes took place around the area. All while the rebulding efforts were taking their first steps.</p>
    </section>

    <section id='number1'>
        <h3>Bhuj after Bhuj<br>2001 - 2019</h3>
        <p>In the years since, Bhuj has had a constant undercurrent of minor earthquakes. At least a handful every year, with 5 earthquakes above 4 on the Richter scale happening this year itself. </p>
    </section>


    <section id='Ending'>
        <h3>Looking Back</h3>
        <p>This was an attempt at understanding how one major, devastating effect not only altered the lives of all the people in and around Bhuj, but also changed the character of the earth itself.</p>
    </section>

    <section>
        <p>Made by Gyan Lakhwani</p>
        <p>Based on <a href="https://vanukuru.github.io/githubSandbox/mapschool19/BhujDataStory">a similiar project</a> by Rishi Vanukuru</p>
        <p>September 2019</p>
    </section>




    </div>


<script>


mapboxgl.accessToken = 'pk.eyJ1IjoiZ3lhbmwiLCJhIjoiY2swNmNoY29kMDA2ZzNjbWN4MmRvbHlmYiJ9.HJHfadzLE1cNqce2G51BEQ';

var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/gyanl/ck0blmyo93cnr1cpji397gs7z',
    center: [80.136,22.305],
    zoom: 1.5
});

var layerNames = [
    'gujaratdistricts',
    'bhujdistrict',
    '24december',
    '24decembertext',
    'oldbhuj',
    'oldbhujtext',
    'prebhujallmain',
    'prebhujallmaintext',
    'bhujdayone',
    'bhujdayonetext',
    'bhujmonthone',
    'bhujmonthonetext',
    'bhujtimesince',
    'bhujtimesincetext',
    'bhujmain'
];


map.on('load', function(){

    for(var i = 2; i<layerNames.length ; i++)
        {
         map.setLayoutProperty(layerNames[i], 'visibility', 'none');
        }

         map.setLayoutProperty('prebhujall', 'visibility', 'none');
         map.setLayoutProperty('postbhujall', 'visibility', 'none');



});


var chapters = {

    'starter':{
        curve:1,
        center: [80.136,22.305],
        zoom: 2,
        bearing: 0,
        pitch: 0,
        duration: 3000

    },

    'opening':{
        curve:1,
        center: [51.251,178.715],
        zoom: 4.01,
        bearing: 0,
        pitch: 0,
        duration: 3000

    },
        'number8':{

        center: [70.355,23.694],
        zoom: 7.52,
        bearing: 0,
        pitch: 0,
        duration: 3000

    },
        'number7':{

        center: [70.355,23.694],
        zoom: 7.52,
        bearing: 0,
        pitch: 0,
        duration: 3000

    },
        'number6':{
        center: [71.696,22.546],
        zoom: 6.40,
        bearing: 0,
        pitch: 20,
        duration: 3000

    },
        'number5':{
        curve:0.5,
        center: [71.883,26.962],
        zoom: 9.92,
        bearing: 5,
        pitch: 30,
        duration: 5000

    },
        'number4':{
        curve:0.1,
        center: [70.355,23.694],
        zoom: 7.52,
        bearing: 0,
        pitch: 30,
        duration: 3000

    },
        'number3':{
        curve:1,
        center: [70.355,23.694],
        zoom: 7.52,
        bearing: 0,
        pitch: 0,
        duration: 3000

    },
        'number2':{
        curve:1,
        center: [70.355,23.694],
        zoom: 7.52,
        bearing: 3,
        pitch: 20,
        duration: 3000

    },
        'number1':{
        curve:1,
        center: [70.355,23.694],
        zoom: 7.52,
        bearing: 0,
        pitch: 0,
        duration: 3000

    },

    'Ending': {
        curve:1,
        center: [80.136,22.305],
        zoom: 3.68,
        bearing: 0,
        pitch: 0,
        duration: 3000
    }

};

var chapterNameArray = Object.keys(chapters);

var chapterLayerData = {

    'layers': [

        {'name': 'starter', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'opening', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number8', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number7', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number6', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number5', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number4', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number3', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number2', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'number1', 'activelayers': ['quakes', 'quakes-text']},
        {'name': 'Ending', 'activelayers': ['quakes', 'quakes-text']}
    ]

};


// On every scroll event, check which element is on screen
window.onscroll = function() {

    var chapterNames = Object.keys(chapters);
    for (var i = 0; i < chapterNames.length; i++) {
        var chapterName = chapterNames[i];
        if (isElementOnScreen(chapterName)) {
            setActiveChapter(chapterName);
            break;
        }
    }
};

var activeChapterName = 'starter';

function setActiveChapter(chapterName) {

    if (chapterName == activeChapterName) return;

    map.flyTo(chapters[chapterName]);

    document.getElementById(chapterName).setAttribute('class', 'active');
    document.getElementById(activeChapterName).setAttribute('class', '');

    setActiveLayers(chapterName);
    activeChapterName = chapterName;

}

function setActiveLayers(chapterName)
    {
        var isFound = false;
        var chapterIndex = -1;
        for(var i = 0; i<chapterNameArray.length ; i++)
            {
                if(!isFound)
                    {
                        if(chapterNameArray[i]==chapterName)
                            {
                            isFound = true;
                            chapterIndex = i;
                            toggleLayerStates(chapterName, chapterIndex);
                            }
                    }


            }

    }


function toggleLayerStates(chapterName, chapterNum)
    {

        for(var i = 0; i<layerNames.length; i++)
            {
                map.setLayoutProperty(layerNames[i], 'visibility', 'none');
            }

        var chapterNameText = chapterNameArray[chapterNum];


        for(var x = 0; x < chapterLayerData.layers[chapterNum].activelayers.length ; x++ )
            {


                for(var i = 0; i<layerNames.length; i++)
                {

                    if(chapterLayerData.layers[chapterNum].activelayers[x] == layerNames[i])
                    {
                        map.setLayoutProperty(layerNames[i], 'visibility', 'visible');
                    }

                }

            }



    }


function isElementOnScreen(id) {
    var element = document.getElementById(id);
    var bounds = element.getBoundingClientRect();
    return (bounds.top < (window.innerHeight/2) && (bounds.bottom > 0) && (bounds.bottom > (window.innerHeight/2 )));
}



</script>

</body>
</html>
